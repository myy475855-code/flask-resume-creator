{% extends "layout.html" %}
{% block content %}
<h2 class="mb-4 text-primary">Certifications</h2>
<p class="text-muted mb-4">Add your professional certifications. You can skip this section if you don't have any.</p>

<form method="POST">
  <div id="certContainer"></div>

  <button type="button" class="btn btn-outline-primary mb-3" id="addCertBtn">+ Add Certification</button>
  <br>

  <button type="submit" class="btn btn-primary">Next: Preview</button>
  <button type="button" class="btn btn-secondary ms-2" id="skipCertBtn">Skip</button>
</form>

<script>
  const certContainer = document.getElementById('certContainer');
  const addCertBtn = document.getElementById('addCertBtn');
  const skipCertBtn = document.getElementById('skipCertBtn');
  let certCount = 0;

  function addCertField() {
    certCount++;
    const div = document.createElement('div');
    div.classList.add('border', 'p-3', 'mb-3', 'rounded', 'bg-light');
    div.innerHTML = `
      <div class="row g-3 align-items-end">
        <div class="col-md-5">
          <label class="form-label">Certificate Name</label>
          <input type="text" class="form-control" name="name_${certCount}" placeholder="AWS Certified Solutions Architect" required>
        </div>
        <div class="col-md-5">
          <label class="form-label">Issuing Organization</label>
          <input type="text" class="form-control" name="org_${certCount}" placeholder="Amazon Web Services" required>
        </div>
        <div class="col-md-2">
          <label class="form-label">Year</label>
          <input type="number" class="form-control" name="year_${certCount}" placeholder="2025" required>
        </div>
        <div class="col-12 text-end">
          <button type="button" class="btn btn-outline-danger btn-sm removeCertBtn">Remove</button>
        </div>
      </div>
    `;
    certContainer.appendChild(div);

    div.querySelector('.removeCertBtn').addEventListener('click', () => div.remove());
  }

  addCertBtn.addEventListener('click', addCertField);
  addCertField(); // Add one default certification

  // Skip button redirects to preview page
  skipCertBtn.addEventListener('click', () => {
    window.location.href = "{{ url_for('choose_template') }}";
  });
</script>
{% endblock %}
